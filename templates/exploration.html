<!DOCTYPE HTML>
<!--
	Projection by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>
	<head>
		<title>Data</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="../static/css/main.css" />
	</head>
	<body class="subpage">

		<!-- Header -->
			<header id="header">
				<div class="inner">
					<a href="{{ url_for('home') }}" class="logo"><strong>SomMLier</strong> by TEMPLATED</a>
					<nav id="nav">
                        <a href="{{ url_for('home') }}">About</a>
                        <a href="{{ url_for('data') }}">Data</a>
                        <a href="{{ url_for('explore') }}">Explore</a>
                        <a href="{{ url_for('label') }}">Got my label</a>
                        <a href="{{ url_for('upload') }}">Need to take a photo</a>
					</nav>
					<a href="#navPanel" class="navPanelToggle"><span class="fa fa-bars"></span></a>
				</div>
			</header>

		<!-- Three -->
			<section id="three" class="wrapper">
				<div class="inner">

					<header class="align-center">
						<h2>Comparing model predictions</h2>
					</header>
            <section id="three" class="wrapper align-center">
                <div class="inner">
                    <div class="flex flex-1">
                        <article>
                            <div class="image square center">
                                <img src="../static/images/pred_pairplot.jpg"/>
                            </div>
                        </article>
                    </div>
                </div>
            </section>   

								<!-- Preformatted Code -->
<h3>Building estimators:</h3>
<pre><code>

description_est = Pipeline([
    ('transformer', ColumnSelectTransformer(['description'])),
    ('corpus', CorpusTransformer()),
    ('vectorizer', TfidfVectorizer()),
    ('Ridge', Ridge())
  ])

price_est = Pipeline([
    ('transformer', ColumnSelectTransformer(['price'])),
    ('ridge', Ridge())
  ])

province_est = Pipeline([
    ('transformer', ColumnSelectTransformer(['province'])),
    ('encoder', DictEncoder()),
    ('vectorizer',DictVectorizer()),
    ('ridge', Ridge())
  ])

variety_est = Pipeline([
    ('transformer', ColumnSelectTransformer(['variety'])),
    ('encoder', DictEncoder()),
    ('vectorizer',DictVectorizer()),
    ('ridge', Ridge())
  ])

winery_est = Pipeline([
    ('transformer', ColumnSelectTransformer(['winery'])),
    ('encoder', DictEncoder()),
    ('vectorizer',DictVectorizer()),
    ('ridge', Ridge())
  ])

  union = FeatureUnion([
    ('description_model', EstimatorTransformer(description_est)),
    ('price_model', EstimatorTransformer(price_est)),
    ('province_model', EstimatorTransformer(province_est)),
    ('variety_model', EstimatorTransformer(variety_est)),
    ('winery_model', EstimatorTransformer(winery_est))
    ])

    wine_estimator = Pipeline([
  ("features", union),
  ("ridge", RandomForestRegressor())
  ])

  X_train, X_test, y_train, y_test = train_test_split(cleaned_wine_data, labels, test_size=0.2, random_state=42)

</code></pre>
            
					<div class="image square center">
						<img src="../static/images/pred_corrplot.jpg"/>
					</div>

                    <p>Pearson's correlations of model predictions</p>  

<h3>Validations</h3>
<pre><code>
from sklearn.model_selection import cross_val_score

scores = cross_val_score(wine_estimator, cleaned_wine_data, labels, cv=5)

print("Accuracy: %s (+/- %s)" % (scores.mean(), scores.std() * 2))

</code></pre>
<h3>Accuracy: 0.857 (+/- 0.119)</h3>                     
                  
				</div>
			</section>

		<!-- Footer -->
			<footer id="footer">
				<div class="inner">

					<div class="copyright">
						&copy; Untitled. Design: <a href="https://templated.co">TEMPLATED</a>. Images: <a href="https://unsplash.com">Unsplash</a>.
					</div>

				</div>
			</footer>

		<!-- Scripts -->
			<script src="../static/js/jquery.min.js"></script>
			<script src="../static/js/skel.min.js"></script>
			<script src="../static/js/util.js"></script>
			<script src="../static/js/main.js"></script>

	</body>
</html>